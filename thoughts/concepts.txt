У нас три языка:
    1. Тот, с которого мы переводим (который определяем)
    2. На который переводим
    3. Тот, который используем для перевода

Макросы - частный случай:
    2 = 3 = base
    1 = расширение base
т.е. макросы просто расширение языка с помощью его самого

Поиск будущего ещё один частный случай:
    1 = запрос на типа естественном языке (на самом деле есть свои ключевые слова и правила)
    2 = условия/дерево запроса
    3 = любой ЯП, например, Javascript

Из каких компонентов всё это дело состоит?
    - эти три языка
    - правила
    - система исполнения правил (возможно на 4м языке), но в простом случае на 3

Порядок как это работает:
    - мы пытаемся применять правила, которые сразу разворачиваются в некий AST,
    - правила могут менять язык (список правил),
    - AST компилируется в 2

    в простом случае (поиск будущего) AST = 2

Как применяются правила?
    просто пытаемся применить все возможные правила (в первом приближении)
    из возможных вариантов выбираем более приоритетные или "более ассоциативные"
    для сматченных правил применяем процедуру разворачивания
